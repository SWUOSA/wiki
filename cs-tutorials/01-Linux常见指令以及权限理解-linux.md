# Linux常见指令以及权限理解

> **本文信息**<br>
> 作者：王茂鑫
> 状态：未审阅的草稿版本<br>
<!-- > （如已完成审阅，请删除上一行，取消本行注释，并删除本提示信息。）状态：已审阅的发布版，审阅人：xxx / 审阅人：[xxx](link)<br> -->
<!-- > （默认采用 CC BY-NC-SA 4.0 协议。如需更换许可，请取消本行注释，并删除本提示信息。）许可：CC BY-NC-SA 3.0 -->

---
## 一、指令

### 1.ls(list)

语法： ls [选项] [目录或文件]

功能：

+   对于目录，该命令列出该目录下的所有子目录与文件
+   对于文件，将列出文件名以及其他信息

常用选项：

+   \-a(all) 列出目录下的所有文件，包括以 . 开头的隐含文件
+   \-d(directory) 将目录像文件一样显示，而不是显示其下的文件。 如：ls –d 指定目录
+   \-l 列出文件的详细信息
+   \-t(time) 以时间排序。

### 2.pwd(print work directory)

语法: pwd

功能：显示用户当前所在的目录

### 3.cd(change directory)

语法：cd [目录名]

功能：改变工作目录。将当前工作目录改变到指定的目录下

举例：

+   cd .. : 返回上级目录
+   cd /home/litao/linux/ : 绝对路径
+   cd ../day02/ : 相对路径
+   cd ~：进入用户家目录
+   cd -：返回最近访问目录

### 4.touch

语法：touch [选项] ...文件...

功能：touch命令参数可更改文档或目录的日期时间，包括存取时间和更改时间，或者新建一个不存在的文件

### 5.mkdir(make directory)

语法：mkdir [选项] dirname...

功能：在当前目录下创建一个名为 “dirname”的目录

常用选项：

+   \-p(parents) 可以创建一个路径。此时若路径中的某些目录尚不存在,加上此选项后,系统将自动建立好那些尚不存在的目录,即一次可以建立多个目录

举例：mkdir –p test/test1 : 在当前目录下，递归建立test/test1路径（多个目录）

### 6.rmdir(remove directory)

rmdir是一个与mkdir相对应的命令。mkdir是建立目录，而rmdir是删除命令

语法：rmdir [-p] [dirName]

适用对象：具有当前目录操作权限的所有使用者

功能：删除空目录

常用选项：

+   \-p 当子目录被删除后，如果父目录也变成空目录的话，就连带父目录一起删除

### 7.rm(remove directory)

rm命令可以同时删除文件或目录

语法：rm [-f-i-r-v] [dirName/dir]

适用对象：所有使用者

功能：删除文件或目录

常用选项：

+   \-f (force)强制删除
+   \-i(interactive) 删除前逐一询问确认
+   \-r (recursive)递归删除目录及其下所有文件

### 8.man(manual)

访问Linux手册页，查看联机手册获取帮助

语法: man [选项] 命令

常用选项：

+   \-k 根据关键字搜索联机帮助
+   num 只在第num章节找
+   \-a 将所有章节的都显示出来，比如 man printf 它缺省从第一章开始搜索，知道就停止，用a选项，当按下q退出，他会继续往后面搜索，直到所有章节都搜索完毕。

补充：

手册分为8个章节：

+   **1号章节** 是普通的命令
+   **2号章节** 是系统调用,如open,write之类的(通过这个，至少可以很方便的查到调用这个函数，需要加什么头文件)
+   **3号章节** 是库函数,如printf,fread4是特殊文件,也就是/dev下的各种设备文件
+   （其余章节不需要掌握）

### 9.cp(copy)

语法：cp [选项] 源文件或目录 目标文件或目录

功能: 复制文件或目录

说明: cp指令用于复制文件或目录，如同时指定两个以上的文件或目录，且最后的目的地是一个已经存在的目录，则它会把前面指定的所有文件或目录复制到此目录中。若同时指定多个文件或目录，而最后的目的地并非一个已存在的目录，则会出现错误信息

常用选项：

+   \-f (force) 强行复制文件或目录， 不论目标文件或目录是否已经存在
+   \-i (interactive) 覆盖文件之前先询问用户
+   \-r/-R (recursive) 递归处理，将指定目录下的文件与子目录一并处理。若源文件或目录的形态，不属于目录或符号链接，则一律视为普通文件处理

### 10.mv(move)

语法: mv [选项] 源文件或目录 目标文件或目录

功能:

1.  若第二个参数类型是目标文件，mv命令将文件重命名。此时，源文件只能有一个（也可以是源目录名），它将所给的源文件或目录重命名为给定的目标文件名
2.  第二个参数类型是目标目录，mv命令将其移至一个新的目录中。此时，源文件或目录参数可以有多个，mv命令将各参数指定的源文件均移至目标目录中

常用选项：

+ \-f (force)如果目标文件已经存在，不会询问而直接覆盖  
+ \-i (interactive)若目标文件 (destination) 已经存在时，就会询问是否覆盖！

### 11.文本查看相关的指令

#### 1.cat(concatenate)

语法：cat [选项] [文件]

功能： 查看目标文件的内容

常用选项：

+   \-b 对非空输出行编号
+   \-n 对输出的所有行编号
+   \-s 不输出多行空行

补充：tac:命令反过来了，打印的内容也反过来了

#### 2.more

语法：more [选项][文件]

功能：more功能类似 cat。全屏幕的方式按页显示文本文件的内容，而且还有搜寻字串的功能 

常用选项：

+   \-n 对输出的所有行编号
+   \-[num] 输出前num行
+   q 退出more

常用操作：

+   空白键（space）：往下一页显示
+    b 键（back）：往回一页显示
+   /字符串：显示所查字符串

#### 3.less

less 工具也是对文件或其它输出进行分页显示的工具

less 的用法比起 more 更加的有弹性。在 more 的时候，我们并没有办法向前面翻， 只能往后面看；但若使用了 less 时，就可以使用 [pageup] [pagedown] 等按键的功能来往前往后翻看文件，更容易用来查看一个文件的内容！

除此之外，在 less 里头可以拥有更多的搜索功能，不止可以向下搜，也可以向上搜。

语法： less [参数] 文件

功能：

less与more类似，但使用less可以随意浏览文件，而more仅能向前移动，却不能向后移动，而且less在查看之前不会加载整个文件

选项：

+   \-[num] 输出前num行
+   \+[num] 跳转到第num行
+   \-i 忽略搜索时的大小写
+   \-N 显示每行的行号
+   /字符串：向下搜索“字符串”的功能
+   ?字符串：向上搜索“字符串”的功能
+   n：重复前一个搜索（与 / 或 ? 有关）
+   N：反向重复前一个搜索（与 / 或 ? 有关）
+   q:quit

#### 4.head

语法： head [参数]... [文件]...

功能：  
head 用来显示档案的开头至标准输出中，默认head命令打印其相应文件的开头10行。

选项：

+   \-[num] 输出前num行

#### 5.tail

语法： tail[必要参数][选择参数][文件]

功能： 用于显示指定文件末尾内容，不指定文件时，作为输入信息进行处理。常用查看日志文件

选项：

+   \-f 循环读取
+   \-[num] 输出后num行

> 举例补充：（重定向和管道）
> 
> 有一个文件共有100行内容，请取出第50行内容<br>
> 
> seq 1 100 > test # 生成1到100的序列装入test
> 
> 方法1：
> 
> head -n50 test > tmp #将前50行装入临时文件tmp
> 
> tail -n1 tmp #得到中建行
> 
> 方法2：
> 
> head -n50 test | tail -n1

### 12.时间相关的指令

date 指定格式显示时间： date +%Y:%m:%d

date 用法：date [OPTION]... [+FORMAT]

1.在**显示方面**，使用者可以设定欲显示的格式，其中常用的标记列表如下：

+ %H : 小时(00..23)

+ %M : 分钟(00..59)

+ %S : 秒(00..61)

+ %X : 相当于 %H:%M:%S

+ %d : 日 (01..31)

+ %m : 月份 (01..12)

+ %Y : 完整年份 (0000..9999)

+ %F : 相当于 %Y-%m-%d

2.在**设定时间方面**

date -s //设置当前时间，只有root权限才能设置，其他只能查看。

date -s 20080523 //设置成20080523，这样会把具体时间设置成空00:00:00

date -s 01:01:01 //设置具体时间，不会对日期做更改

date -s “01:01:01 2008-05-23″ //这样可以设置全部时间

date -s “01:01:01 20080523″ //这样可以设置全部时间

date -s “2008-05-23 01:01:01″ //这样可以设置全部时间

date -s “20080523 01:01:01″ //这样可以设置全部时间

3.**时间戳**

时间->时间戳：date +%s

时间戳->时间：date -d@1508749502

Unix时间戳（英文为Unix epoch, Unix [time](https://so.csdn.net/so/search?q=time&spm=1001.2101.3001.7020), POSIX time 或 Unix timestamp）是从1970年1月1日（UTC/GMT的午夜）开始所经过的秒数，不考虑闰秒。

### 13.cal(calendar)

命令格式： cal [参数] [月份] [年份]

功能： 用于查看日历等时间信息，如只有一个参数，则表示年份(1-9999)，如有两个参数，则表示月份和年份

常用选项：

+   \-3 显示系统前一个月，当前月，下一个月的月历
+   \-j 显示在当年中的第几天（一年日期按天算，从1月1号算起，默认显示当前月在一年中的天数）
+   \-y 显示当前年份的日历

### 14.find -name

语法： find pathname -options

功能： 用于在文件树中查找文件，并作出相应的处理（可能访问磁盘）

常用选项：

+   \-name 按照文件名查找文件

举例：

find /home -name test.c

### 15.which

语法：which 搜寻命令

功能：只用来搜索命令

### 16.alias

语法：alias 指令='别名'

功能：对指令进行重命名

举例：alias ls -l='ll'

### 17.whereis

语法：whereis 指令或文档

功能：在特定路径下，查找指定[文件名](https://so.csdn.net/so/search?q=%E6%96%87%E4%BB%B6%E5%90%8D&spm=1001.2101.3001.7020)对应的指令或文档

举例：whereis test.c

### 18.文本操作相关的指令

#### 1.grep

文本内容的行过滤工具

语法： grep [选项] '搜寻字符串' 文件

功能： 在文件中搜索字符串，将找到的行打印出来

常用选项：

+   \-i ：忽略大小写的不同
+   \-n ：顺便输出行号
+   \-v ：反向选择，亦即显示出没有 '搜寻字符串' 内容的那一行

#### 2.wc -l（word count -lines）

语法：wc -l filename

功能：统计文件中的行数

举例：wc -l test.txt

#### 3.sort

语法：sort filename

功能：对文本内容进行排序

#### 4.uniq(unique)

语法：uniq filename

功能;对文本内容进行去重

### 19.zip/unzip

语法： zip 压缩文件.zip 目录或文件

功能： 将目录或文件压缩成zip格式

常用选项：

+   \-r 递归处理，将指定目录下的所有文件和子目录一并处理

>举例：  
>
>将test2目录压缩：
>  
>zip test2.zip test2/\*
>  
>zip test2.zip -r test2
>  
>解压到tmp目录：
>  
>unzip test2.zip -d /tmp

>补充: 
>1. zip对一个目录进行打包压缩的时候，默认只会对目录本身打包压缩  
>（zip test.zip /home/test） 
>2. unzip默认解压到当前路径  
>（unzip test2.zip:解压到当前路径）  
>（unzip test2.zip -d pathname:解压到指定路径）

### 20.tar

语法：

tar [选项] 压缩文件.tgz 目录或文件

打包并压缩：tar -czf test.tgz test

解包并解压：tar -xzf test.tgz test

功能：打包/解压，不打开他，直接看内容

tar [-cxtzjvf] 文件与目录 .... 参数：

+   \-c (create)：建立一个压缩文件
+   \-x ：解开一个压缩文件
+   \-f ：使用文档名，（在 f 之后要立即接文档名，不要再加参数）
+   \-t ：查看不用打开压缩文件，直接查看压缩包里的文件内容（tar -tf test.tgz）
+   \-v ：压缩/解压过程中同步显示压缩文件列表（tar -czvf test.tgz test）
+   \-C ： 解压到指定目录（tar -xzf test.tgz test -C /home）

### 21.bc

bc命令可以很方便的进行浮点运算

### 22.uname 

语法：uname [选项]

功能： uname用来获取电脑和操作系统的相关信息。

补充说明：uname可显示linux主机所用的操作系统的版本、硬件的名称等基本信息。

常用选项：

+   \-a(all) 详细输出所有信息，依次为内核名称，主机名，内核版本号，内核版本，硬件名，处理器类型，硬件平台类型，操作系统名称

### 23.重要热键[Tab],[ctrl]-c, [ctrl]-d

[Tab]按键---『命令补全』和『档案补齐』

[Ctrl]+c按键---终止前台异常程序

[Ctrl]+d按键---退出当前用户，通常代表着：『键盘输入结束(End Of File, EOF 戒 End OfInput)』的意思；也可以用来取代exit

[Ctrl]+r按键---搜索历史命令，左右即可选中

### 24.关机

语法：shutdown [选项]

常见选项：

+   \-h：将系统的服务停掉后，立即关机
+   \-r：在将系统的服务停掉之后就重新启动
+   \-t sec：-t 后面加秒数，亦即『过几秒后关机』的意思

## 二、shell的命令及运行原理

Linux严格意义上说的是一个操作系统，我们称之为“核心（kernel）“ ，但我们一般用户，不能直接使用kernel。而是通过kernel的“外壳”程序，也就是所谓的shell，来与kernel沟通。

从技术角度，Shell的最简单定义：命令行解释器（command Interpreter）

主要包含：

将使用者的命令翻译给核心（kernel）处理；将核心的处理结果翻译给使用者

linux发展至今,有许多shell程序,其中一款软件叫做bash

## 三、Linux权限

### 1.linux权限概念

Linux下有两种用户：超级用户（root）、普通用户

+ 超级用户：可以在linux系统下做任何事情，不受限制

+ 普通用户：在linux下做有限的事情。

超级用户的命令提示符是“#”，普通用户的命令提示符是“$”

命令：su [用户名]

功能：切换用户

例如，要从root用户切换到普通用户user，则使用 su user。 要从普通用户user切换到root用户则使用 su root（root可以省略），此时系统会提示输入root用户的口令

补充：

su -:重新登录

配置sudo必须通过编辑/etc/sudoers文件，而且只有超级用户才可以修改它。

sudo command:短暂提权，以root身份执行命令（需要是受信任的用户，且输入用户密码）

### 2.Linux权限管理

#### (1)文件访问者的分类

文件和文件目录的所有者：u---User

文件和文件目录的所有者所在的组的用户：g---Group

其它用户：o---Others 

#### (2)文件类型和访问权限（事物属性）  
 

![](https://i-blog.csdnimg.cn/direct/dfbf0a92d34f43b7a3800c253c4ba8ba.png)

a) 文件类型

+   d：目录文件
+   \-：普通文件
+   l：软链接文件（类似Windows的快捷方式）
+   b：块设备文件（硬盘、光驱等）
+   p：管道文件
+   c：字符设备文件（屏幕等）

b)基本权限

1.  读（r/4）：Read对文件而言，具有读取文件内容的权限；对目录来说，具有浏览该目录信息的权限
2.  写（w/2）：Write对文件而言，具有修改文件内容的权限；对目录来说具有删除移动目录内文件的权限
3.  执行（x/1）：execute对文件而言，具有执行文件的权限；对目录来说，具有进入目录的权限
4.  “—”表示不具有该项权限

#### (3)文件权限值的表示方法

1）字符表示方法

rwx-

2)8进制数值表示方法

<table border="1" cellpadding="1" cellspacing="1" style="width:500px"><tbody><tr><td>权限符号（<span style="color:#fe2c24">读</span><span style="color:#a2e043">写</span><span style="color:#ffd900">执行</span>）</td><td>八进制</td><td>二进制</td></tr><tr><td>r--</td><td>4</td><td>100</td></tr><tr><td>-w-</td><td>2</td><td><p>010</p></td></tr><tr><td>--x</td><td>1</td><td>001</td></tr><tr><td>rw-</td><td>6</td><td>110</td></tr><tr><td>r-x</td><td>5</td><td>101</td></tr><tr><td>-wx</td><td>3</td><td>011</td></tr><tr><td>rwx</td><td>7</td><td>111</td></tr><tr><td>---</td><td>0</td><td>000</td></tr></tbody></table>

#### (4)文件访问权限的相关设置方法

##### a)chmod

说明：只有文件的拥有者和root才可以改变文件的权限

功能：设置文件的访问权限

常用选项：

\-R -> 递归修改目录文件的权限

说明：只有文件的拥有者和root才可以改变文件的权限

格式：chmod [参数] 权限 文件名

**chmod命令修改权限的格式：**

**① 用户表示符+/-/=权限字符**

+   +:向权限范围增加权限代号所表示的权限
+   \-:向权限范围取消权限代号所表示的权限
+   \=:向权限范围赋予权限代号所表示的权限

用户表示符：

+   u：拥有者
+   g：拥有者同组用
+   o：其它用户
+   a：所有用户

举例：

chmod u+w /home/abc.txt

chmod o-x /home/abc.txt

chmod a=x /home/abc.txt

**②三位8进制数字**

举例：

chmod 664 /home/abc.txt

chmod 640 /home/abc.txt

##### b)chown

功能：修改文件的拥有者

格式：chown [参数] 用户名 文件名

常用选项：

\-R -> 递归修改目录文件的拥有者

说明：root权限才能使用

举例：

chown user1 test.txt

chown -R user1 test.txt

##### c)chgrp

功能：修改文件或目录的所属组

格式：chgrp [参数] 用户组名 文件名

常用选项：-R 递归修改文件或目录的所属组

##### d)umask

功能：

查看或修改文件掩码

新建文件默认权限=0666

新建目录默认权限=0777

但实际上你所创建的文件和目录，看到的权限往往不是上面这个值。原因就是创建文件或目录的时候还要受到umask的影响。假设默认权限是mask，则实际创建的出来的文件权限是:

**mask & ~umask**

![](https://i-blog.csdnimg.cn/direct/fa28da10448b4736b46911dd431ab711.png)

直观理解：想要去掉的权限，其umask二进制位为1

格式：umask 权限值

说明：超级用户默认掩码值为0022，普通用户默认为0002

举例：

umask //查看

umask 044//设置

#### (5)目录权限

+   x可执行权限: 如果目录没有可执行权限, 则无法cd到目录中
+   r可读权限: 如果目录没有可读权限, 则无法用ls等命令查看目录中的文件内容.
+   w可写权限: 如果目录没有可写权限, 则无法在目录中创建文件, 也无法在目录中删除文件

目录的x权限理解：

1.  目录的可执行权限（-x）是表示你可否在目录下执行命令
2.  如果目录没有-x权限，则无法对目录执行任何命令，甚至无法 cd 进入目录, 即使目录仍然有-r 读权限（这个地方很容易犯错，认为有读权限就可以进入目录读取目录下的文件）
3.  而如果目录具有-x权限，但没有-r权限，则用户可以执行命令，可以 cd 进入目录。但由于没有目录的读权限，所以，在目录下，即使可以执行ls命令，但仍然没有权限读出目录下的文档

#### (6)粘滞位

语法：chmod +t 目录

功能：由root创建公共目录，普通用户各自可以进行rwx操作，但要禁止删除别人的文件

理解：

1.  root创建目录，针对公共目录，普通用户是other，就必须将目录的other权限设为rwx
2.  普通用户在公共目录下创建文件，针对文件，该用户为owner，其余用户为other
3.  公共目录下，文件的拥有者可以将文件的other权限设为---，其余用户不能查看/修改/执行。但是由于目录的other权限为rwx,所以用户可以删除别人的文件
4.  给目录设置粘滞位，可以禁止删除别人的文件（权限的一种特殊情况）

> 举例：
> 
> 修改前的公共目录:
> 
> drwxrwxrwx 3 root root 4096 9月 19 16:00 /home/
> 
> [root@localhost ~]# chmod +t /home/ # 加上粘滞位
> 
> 修改后：
> 
> drwxrwxrwt 3 root root 4096 9月 19 16:00 /home/

当一个目录被设置为"粘滞位"(用chmod +t),则该目录下的文件只能由

1. 管理员删除

2. 该目录的所有者删除

3. 该文件的所有者删除
